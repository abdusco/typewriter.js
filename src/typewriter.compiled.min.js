(function(global){"use strict";function typewriter(typeables,options){function extend(from,to){Object.keys(from).forEach(function(k){if(!k in to){return}to[k]=from[k]});return to}function typeLetters(el,word,delay){return new Promise(function(resolve,reject){var i=0;var max=word.length-1;waitComplete(delay,function(){var rafid=requestAnimationFrame(function(){if(i<=max){el.innerHTML+=word[i++]}else{cancelAnimationFrame(rafid);resolve()}})})})}function deleteLetters(el,delay){return new Promise(function(resolve,reject){var content=el.innerHTML;var nextLength=content.length-1;var id=setInterval(function(){var rafId=requestAnimationFrame(function(){el.innerHTML=content.substring(0,nextLength--);cancelAnimationFrame(rafId)});if(nextLength<0){clearInterval(id);resolve(el)}},delay)})}function waitComplete(delay,cb){setTimeout(function(){cb();waitComplete(delay,cb)},delay)}function advanceWord(typee){var id=setTimeout(function(){typee.current=(typee.current+1)%typee.words.length;var next=typee.words[typee.current];console.log(typee.current,next);if(next==undefined){debugger}deleteLetters(typee,options.delay).then(function(el){return typeLetters(typee,next,options.delay)}).then(function(){clearTimeout(id);setTimeout(advanceWord(typee),options.waitBefore)})},options.waitAfter)}function typeWords(typee){typee.words=typee.dataset[options.data].split(options.delimiter);if(!typee.words.length){return}typee.current=-1;setTimeout(function(){advanceWord(typee)},options.waitFirst)}function init(){if(!typeables.toString()!=="[object NodeList]"){if(typeof typeables==="string"){typeables=document.querySelectorAll(typeables)}else if(typeables.toString()==="[object HTMLBodyElement]"){typeables=[typeables]}else{throw new Error("Please provide a valid selector or element")}}var DEFAULTS={data:"typewriter",delimiter:",",waitFirst:3e3,waitBefore:100,waitAfter:1e3,delay:100};options=extend(options||{},DEFAULTS);[].slice.call(typeables).forEach(function(typee){return typeWords(typee,options.waitAfter)})}init()}if(typeof define==="function"&&define.amd){define(function(){return typewriter})}else if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=typewriter}exports.typewriter=typewriter}else{global.typewriter=typewriter}})(this);